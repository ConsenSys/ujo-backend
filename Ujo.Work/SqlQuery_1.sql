DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Ujo.Repository.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201701271251002_InitialCreate'
BEGIN
    CREATE TABLE [dbo].[Artists] (
        [Address] [nvarchar](128) NOT NULL,
        [Name] [nvarchar](max),
        [Bio] [nvarchar](max),
        [Genre] [nvarchar](max),
        [Image] [nvarchar](max),
        CONSTRAINT [PK_dbo.Artists] PRIMARY KEY ([Address])
    )
    CREATE TABLE [dbo].[CreativeWorkArtists] (
        [CreativeWorkArtistId] [int] NOT NULL IDENTITY,
        [CreativeWorkAddress] [nvarchar](128) NOT NULL,
        [ArtistAddres] [nvarchar](128),
        [ContributionType] [nvarchar](max),
        [Role] [nvarchar](max),
        [NonRegisteredArtistName] [nvarchar](max),
        CONSTRAINT [PK_dbo.CreativeWorkArtists] PRIMARY KEY ([CreativeWorkArtistId])
    )
    CREATE INDEX [IX_CreativeWorkAddress] ON [dbo].[CreativeWorkArtists]([CreativeWorkAddress])
    CREATE INDEX [IX_ArtistAddres] ON [dbo].[CreativeWorkArtists]([ArtistAddres])
    CREATE TABLE [dbo].[CreativeWorks] (
        [Address] [nvarchar](128) NOT NULL,
        [ByArtistAddress] [nvarchar](128),
        [Name] [nvarchar](max),
        [Image] [nvarchar](max),
        [Description] [nvarchar](max),
        [Audio] [nvarchar](max),
        [Creator] [nvarchar](max),
        [Genre] [nvarchar](max),
        [Keywords] [nvarchar](max),
        [Publisher] [nvarchar](max),
        [HasPart] [bit],
        [IsPartOf] [bit],
        [IsFamilyFriendly] [nvarchar](max),
        [License] [nvarchar](max),
        [DateCreated] [nvarchar](max),
        [DateModified] [nvarchar](max),
        [MusicCollectionType] [nvarchar](max),
        [NumberOfTracks] [int],
        [IsrcCode] [nvarchar](max),
        [IswcCode] [nvarchar](max),
        [Label] [nvarchar](max),
        [Discriminator] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.CreativeWorks] PRIMARY KEY ([Address])
    )
    CREATE INDEX [IX_ByArtistAddress] ON [dbo].[CreativeWorks]([ByArtistAddress])
    CREATE TABLE [dbo].[MusicCollectionTracks] (
        [MusicCollectionTrackId] [int] NOT NULL IDENTITY,
        [MusicCollectionAddress] [nvarchar](128),
        [MusicRecordingAddress] [nvarchar](128),
        [Number] [int] NOT NULL,
        [OtherInfo] [nvarchar](max),
        CONSTRAINT [PK_dbo.MusicCollectionTracks] PRIMARY KEY ([MusicCollectionTrackId])
    )
    CREATE INDEX [IX_MusicCollectionAddress] ON [dbo].[MusicCollectionTracks]([MusicCollectionAddress])
    CREATE INDEX [IX_MusicRecordingAddress] ON [dbo].[MusicCollectionTracks]([MusicRecordingAddress])
    CREATE TABLE [dbo].[CreativeWorkCreativeWorks] (
        [CreativeWork_Address] [nvarchar](128) NOT NULL,
        [CreativeWork_Address1] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.CreativeWorkCreativeWorks] PRIMARY KEY ([CreativeWork_Address], [CreativeWork_Address1])
    )
    CREATE INDEX [IX_CreativeWork_Address] ON [dbo].[CreativeWorkCreativeWorks]([CreativeWork_Address])
    CREATE INDEX [IX_CreativeWork_Address1] ON [dbo].[CreativeWorkCreativeWorks]([CreativeWork_Address1])
    ALTER TABLE [dbo].[CreativeWorkArtists] ADD CONSTRAINT [FK_dbo.CreativeWorkArtists_dbo.Artists_ArtistAddres] FOREIGN KEY ([ArtistAddres]) REFERENCES [dbo].[Artists] ([Address])
    ALTER TABLE [dbo].[CreativeWorkArtists] ADD CONSTRAINT [FK_dbo.CreativeWorkArtists_dbo.CreativeWorks_CreativeWorkAddress] FOREIGN KEY ([CreativeWorkAddress]) REFERENCES [dbo].[CreativeWorks] ([Address]) ON DELETE CASCADE
    ALTER TABLE [dbo].[CreativeWorks] ADD CONSTRAINT [FK_dbo.CreativeWorks_dbo.Artists_ByArtistAddress] FOREIGN KEY ([ByArtistAddress]) REFERENCES [dbo].[Artists] ([Address])
    ALTER TABLE [dbo].[MusicCollectionTracks] ADD CONSTRAINT [FK_dbo.MusicCollectionTracks_dbo.CreativeWorks_MusicCollectionAddress] FOREIGN KEY ([MusicCollectionAddress]) REFERENCES [dbo].[CreativeWorks] ([Address])
    ALTER TABLE [dbo].[MusicCollectionTracks] ADD CONSTRAINT [FK_dbo.MusicCollectionTracks_dbo.CreativeWorks_MusicRecordingAddress] FOREIGN KEY ([MusicRecordingAddress]) REFERENCES [dbo].[CreativeWorks] ([Address])
    ALTER TABLE [dbo].[CreativeWorkCreativeWorks] ADD CONSTRAINT [FK_dbo.CreativeWorkCreativeWorks_dbo.CreativeWorks_CreativeWork_Address] FOREIGN KEY ([CreativeWork_Address]) REFERENCES [dbo].[CreativeWorks] ([Address])
    ALTER TABLE [dbo].[CreativeWorkCreativeWorks] ADD CONSTRAINT [FK_dbo.CreativeWorkCreativeWorks_dbo.CreativeWorks_CreativeWork_Address1] FOREIGN KEY ([CreativeWork_Address1]) REFERENCES [dbo].[CreativeWorks] ([Address])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201701271251002_InitialCreate', N'Ujo.Repository.Migrations.Configuration',  0x1F8B0800000000000400ED5DDD6EE3B815BE2FD0771074B55BCCDA49E6661BD8BB483293D6D8493C88936DEF025AA21DEDE8C715E94C8CA24FD68B3E525FA1D43FC51F89142539932E1618C414F9F1F0F0F0F01C92E7EC7FFFFD9FD9CF2F816F3DC318795138B74F2727B605432772BD703BB7F778F3C38FF6CF3FFDF10FB38F6EF062FD5AD47B9FD4232D4334B79F30DE9D4FA7C87982014093C073E208451B3C71A2600ADC687A7672F2E7E9E9E91412089B6059D6EC6E1F622F80E90FF2F32A0A1DB8C37BE0DF442EF4515E4EBEAC5254EB160410ED8003E7F6C36FD1E40EEE22E4E1283ED8D685EF0142C50AFA1BDB0261186180098DE70F08AE701C85DBD58E1400FFFEB083A4DE06F808E6B49F57D555877172960C635A352CA09C3DC251A00978FA3EE7CB946DDE89BB76C937C2B98F84C3F8908C3AE5DEDCBE88B187B06DB15D9D5FF971522D636D3A0193ACEE3BAB2C7957CE3D1191E4BF77D6D5DEC7FB18CE43B8C73120353EEFD7BEE7FC020FF7D11718CEC3BDEFD314119AC8B75A0129FA1C473B18E3C31DDC1474BA6E0C11B2AD69BDF1946D5DB6651B66A321B34F84D8B66EC0CB27186EF11311EFB31F6DEBDA7B816E51928BC343E81199278D70BC273F6F09E960EDC3F2FBB4B1E3E4DF865EC99F4ABD367772E94583F7F11718C6C38F6411806DDFBDCCA695BC37AE82AB1812A97F867F8BE22F3A2B826F779CD5C1D3B170F5978A18251BF322C4EFCF046B80E2CF8AA85E488405C60043F733C018C644E32D5C98B2BB4D006ABD1F6BD166C3CEBAEFA1F796114721815EEF13EE255D0DBEC6EE227FF84E6EA3F00E6E0917610CDD8C9FC3A8C25BF0EC6D53D1134EA26DDD413FFD8C9EBC5D660B0816EC6351FB3A8E828441A27590577A5C45FBD8498612B5D5BC07F11662759A692455CAEB6D1AE9A78B544651AB2F1A4B27D5AAAF547B50A7D6C51A91AF0ECEC5E8FFC2F8B83CD09A6C7855368AB1338489C0F7F2012227F67699BD3D705F177B7704032E5D5051FC460C45B2E6BE46B1DB24D3FD74942A13F4048767DC5F01FA0C625CF4731911B50CC2D6E590365A6EB49B5D83C0F30FD7B10743D73F0C3EBA4F9E034334C2C22566672AEAD01DA52FB22B791B6F88CEA45642A1D65B2D84C7AAA6D82E282B345A03552D137B062DC27682B90612BA997ACDE4B3958D46F18092B91E6A1C05694AE32806AD3A8E25266A2C9B4934B475D93490266BB4937579B3479E7315F93E74B20D5BC5C0641AF561635E0204732DC0B2D36E54240C2DA3B881B7FB600DE3E5E69E58C55F509B87AF2A63059A40BAD84126351FB9A9AB444CA53E27674A8DFA14B6B4874E1297B63CCE499188922E6745329CB14E8B98FEC7F273D26EEFA0430C50D2C168DE55BA603517AA680B58849B01DC0DA94AE096F858BA81350AB4148AD6E84A59D01C1CD54E656C65758DA1556D8C0E70587295F55DD9E6A81BEC02C5843DEE08A713E8EB381D7D026BE88F7453728150E478E93C4B2F098A13D43AD11F43D7523E4E154F6CE1C1DC1009F1764426088173FB4F1C7F54BA2AAD85AA2B31FCC96472CAF540F64F18271B13F0AFC8022772EA8598DF6CBDD0F176C057258601D0397A4C66ACEC8FFDF201EE88674FC8559D0025426A37233C3565A78C21D1C6BAD994923175D1AB1C5C15591078BB125DD251D87847F94882C611720C21E3D8AD420477647D7C19637D792549901E50F42C71D203844EFD68B048C962930D41CF7CAB8622F6BDD459A7E7524AFB1D6E11EB1038D69AD6992C159A644EDB5156BA8A6DAE2F4D02437D0C21E66D7DB65BCA821F5F8439F28E2FC1DC44290B30EFFE1F7DA7121DD96AD8C8E2D701031AE5E20363B58DEB949DA9D932FC007D88A175E1648F2CAF007280CB3B52C4C9718731EC45033AA2792F9A501572846FB04690EECCF94CDE43911630CEA979F82D4A8AE08BE835DE0382F9C103123EECC8205710D7FC17329CCAD165CC734E80EB003C9B4560A2A5A201DC06D90A2652782250F156C48053B3D5C487F2091555BFF5BD152B543AE705E5A025B3C249ACCE0901052E01AC8931A9A8C934EA6EB69961121F57C3CB95304A9D45BC5F3B3C7BB81BD4162E357A69FA7E9A39CF649E992A720706AA9DA2F38CD4F7E5BA7B73D4F0255AAA81C15AFEDB51184D19D83A7C96381B9DDD8D81B8CC3B180332B9F53582D24623B7863BD9C3FD6E3A420BB807961607F9A52D557E9B4DB3B0A9BC603695C457CD6EC06E47269A8AB7CA4BAC55166C75F5C34A3F1229C830A60E12042495D4963DE128065BC87C4D9ECCBBF0DA8B11FE00305883E456E3CA0DB86A94E52831978A8EEAC6213F8585D954D44FFE2EAD532AE46C22DEA92BE65D93F10489D19E5E7C73BB28DFD04AE2DC800F62D99B62B24EF741D8E247C871B227BB344856A28E90061FD10069817AFBFCBD288D9017A963E46F82698CBC88C7984D99B9E01C1B6EBE39FFB12E3E4AC225D216068226F030F4854E0544C6727198103D032AE148CA3D88C45DC94F95E3D7EFB26AEBA8F196AB81622E94A7462EF7551D398BD9A1D1B2128D852E0BC8A9AD7D59A557B98CF416D002257F2F37DF35ACA4EF0D17D1F8FA9BBB2FAB69E2B6CBB4067131DE177474B20CA316854123D53E682CF92CD2A2C6F3AC48532D2571149C2A4A0AC7DDF7AA28081AA62A5547A2C21C6828AA581DAB0C64A091CA420D092A431B6A425496EA20B1D10E7544F6AB3A7219D6400396851A924E872DD4249DFEA087578526B080D597FE15BB9E1DD372CAF0EAF5AFF0E5368D29ACA0A1879957DA358DCC7C13A212ABC3F5D20BA35F81BFE7096284C34BF46AE085326D7604E9909E8DBC7AE1A85E1DD6D54D51AA83F45588F4551B297F37585357599186F850A75CA34A4F47A3517C04D69FD6CAEE4DF4A5530D4655F5148FEF9BB48FF8A1BF462FC2A5A1FAA2A3A517FE4A9DEBA4FDD65DDE47F17E9E57A13A28D40B7A1A882A1E5FECEBE780728789BF54513A5FE09B35A9D9B603D7062F5F761BC333545D6DD7F01B6EB329CA0C89965EFC9B11CD3DCF69A29A3D1BE6C5863B2266AB94425B1E153347C2B3FC78B63D2F17775E9B55B12D42FBB3E72667B5AB03C23098241526AB7FF8573E31C57155E10684DE06229C0503D86727A7674C7AAFD7936A6B8A90EB0B8EB7F97C5BF5291B350945F80C62E709C47C9C924182AB02F4BB00BC7C4F236926B132C2A9E51F3042AA659AD040324938D5412454CE59CDD23E79C9526C0DD5D3141CE1E92D2B9CDC839F45E8C297B9FDCF14E4DC5AFCFD5180F3CE5AC644699C5B27D6BF8C055C940C4A8B401A40953293C45146324F278732026A490035F4727A13BA5592BF474BFA188C3E05B037D5DF55D1F24882B43D4678B5D43C4648E509F1ABDAE2D8343A46605CAA1C2334261DCEDAC3DA62C5A4C6E904214E9363343226158E99C0F3E96E8CF1D8943646800DA92DCCF61761FA8AD452D19DE27A68B0992663C27FCDE4840EF1359BD5FAC19CD136659628A3C3B63C4EB28A416CDCE6FC145AFBB818AACFEDBC31AB853EAD2C52AF96472D1506B3E8BB25C218DA2035354E15CFB1D41AF2A15E5AFEE1635FFEDAE3100E9B64C03D917A6A40EB90F9158A60826E11E74DAF548D83C03A8557491FB58D153EF536F3210C21260651EDDF9A68BC911C06C28B15D3D955151725F011C4487B5EFB16266D0254EFB28E2D5DA21BB0DFA5EB5B942EE1A5E351D332286417E9245F2DFB9D3852D638ABC3B7235A8A4F5EDE70BA8FDFC5EAD589D51B4AC2719CCC17AFCFEF3BFABEA9E15DBCAE44197C54243BD7A25C180DA930B2573A73DB5D27A764D9A9862CDABF3D4F86629A0C51A70A91B68D04B4A6D368EBB4BD3BB19E564CB821EA5E296CBB71D41A1CD0E34633678E932EA42E637448AD5E48764B8477CF61EDBD260131678174F07D0F5B721CA199E343F23CD474708AAEA5CAF3D781D956640CD0649BF881EA9B62DB9132A19833AE691F91C70C0CC9B001339A7CBBEC6AB3F807CB4D62BE1CFBDEE734728DF00FC689114CFDEF9E895D8EBC6D0591441F85D9C455A0459DE4F2B630C9198A8A2AEC0537C4C025B67132C40D7030F9EC10933D15ED3CBAE963B086EE225CEEF16E8FC99061B0AEC78326D67C53FF6942953ACDB365FA1E0DF5310442A647860097E1E5DEF3DD92EE6BC165A304227113F2270EC95CE2E4A9C3F65022DD46A12250CEBED2BBB987C1CE27606819AEC033EC42DB03829FE0163887E2DDBF1CA47D22EA6C9F7DF0C0360601CA31AAF6E42791613778F9E97F0766B958F57C0000 , N'6.1.3-40302')
END

